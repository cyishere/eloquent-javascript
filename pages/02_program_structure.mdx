import Layout from "@/components/Layout";

<Layout
  meta={{
    chapter: "第二章",
    title: "程序结构",
    description: "解释JavaScript的程序结构、构造",
  }}
>

> 我的心脏在薄薄的、透明的皮肤下面发出明亮的红色光芒。他们得提供 10cc 的 JavaScript 才能把我救回来。（我对血液中毒素的反应很好。）天哪，那东西能让你把嘴里的东西全都吐出来！
>
> ——\_why, Why's (Poignant) Guide to Ruby

![程序结构](/img/chapter_picture_2.jpeg)

在这章中，我们将做一些能够真正称为*编程*的事情。我们已经见过了一些在 JavaScript 语言中以名词和句子片段构成的命令，接下来我们要对其进行扩展，从而表达出更具有意义的篇章。

- expression：表达式
- statement：语句

## 表达式和语句

在[第一章](/01_values)中，我们写出了值，并通过把运算符运用在它们身上而获得新的值。像这样创建值就是 JavaScript 程序中的主要事务。但是这种事务必须要放置在更大的结构中才能真的有用处。这就是我们接下来要讲的内容。

一段可以产生值的代码片段被称为*表达式*。每一个被写出来的值（例如`22`或者`"心理分析"`）都是一个表达式。括号中间的表达式也是表达式。一个二元运算符作用于两个表达式，一个一元运算符作用于一个表达式。

这可以显示出基于语言的界面系统美好的部分。就像人类语言可以互相嵌套一样，表达式可以包含其他的表达式。这就允许我们创建能够描述不受约束地复杂运算的表达式。

如果说表达式对应的是句子片段，那么 JavaScript 语句就是对应一个完整的句子。一个程序就是一串语句。

最简单的语句就是在一个表达式后面加上一个英文分号（以下均简称「分号」）。这就是一段程序：

```javascript
1;
!false;
```

当然，这是一段没啥用处的程序。一个表达式可以只用于产生一个值，然后这个值将被其周围的代码使用。而语句是独立的，所以只有在对世界造成影响的时候它才有意义。它可以让显示器显示内容——这也算影响世界了，或者它可以以某种方式改变机器的内部状态，并且这种改变会影响后面语句的运行。这些改变被称为*副作用*。前面例子中的语句只是产生了两个值：`1`和`true`，然后这俩值就消失不见了。这完全不能给世界留下什么印象。当你运行这段程序的时候，没有值得注意的事情发生。

在某些情况下，JavaScript 允许省略语句末尾的分号。在另一些情况下，却不能省略，因为那种情况下可能两个语句可能会被误认为一个语句。什么时候能省略分号的规则既复杂又容易出错，所以在这本书中，每个需要用到分号的语句都会有分号。我也推荐你这样做，至少在你还不熟悉省略分号的微妙性之前，还是写它吧。

## 绑定（bingding）

> 这里还有个概念是*state*（状态），在以后的 JavaScript 编程中还会不断地遇到。

一个程序是如何保留内部状态的呢？它是怎么记住东西的呢？我们已经见过使用旧的值产生新的值了，但这并不会改变旧的值，且新的值需要被立即使用，否则它就又消失不见了。为了获取和保留值，JavaScript 提供了一个功能叫*绑定*，也称为*变量*。

```javascript
// caught: 捕获
let caught = 5 * 5;
```

这是第二类语句。这个特殊的词（_关键词_）`let`指明了这个句子是用于定义一个绑定。它后面紧跟着这个绑定的名称。如果我们想要立马就给它一个值的话，那么就像上例中，后面再跟一个`=`运算符和一个表达式。

上面的语句创建了一个名为`caught`的绑定，并用它来获取和保留 5 乘以 5 所产生的数值。

当一个绑定完成之后，它的名称可以被当作表达式来使用。此时这个表达式所代表的值就是这个绑定本身现在保留的那个值。情况下面的例子：

```javascript
let ten = 10;
console.log(ten * ten);
// -> 100
```

当一个绑定指向一个值时，不代表它永远都跟那个值绑在一起了。通过使用`=`操作符可以随时把现有的绑定指向新的值，而接触它与现有值的连接。

```javascript
// mood: 色调、气氛；light: 明亮；dark：黑暗
let mood = "light";
console.log(mood);
// -> light

mood = "dark";
console.log(mood);
// -> dark
```

你不要把绑定想象成是盒子，而要把它想象成是章鱼的触手。它们不*包含*值，而是它们*抓着*值——例如两个绑定可能都抓着相同的值。程序只能获取「被抓着」的值。当你需要记住什么的时候，就新长出一个触手来抓着它，或者让现有的触手放掉手里的东西来抓住这个新的。

再来看一个例子。为了记住 Luigi 欠你的钱，你创建了一个绑定。之后，当他还给你 35 元的时候，你要给这个绑定一个新的值。

```javascript
// debt: 欠账
let luigisDebt = 140;
luigisDebt = luigisDebt - 35;
console.log(luigisDebt);
// -> 105
```

当你没有给绑定赋值的时候，触手就是空空如也。当查询一个空绑定的时候，就会获得`undefined`这个值。

一个`let`开头的语句可以定义多个绑定，它们必须以英文逗号分开。

```javascript
let one = 1,
  two = 2;
console.log(one + two);
// -> 3
```

关键词`var`和`const`和`let`相似，都可以用于创建绑定。

```javascript
// greeting：打招呼
var name = "Ayda";
const greeting = "Hello ";
console.log(greeting + name);
// -> Hello Ayda
```

第一个`var`是「前 2015 时代」时 JavaScript 用于定义绑定的方式，var 是单词 variable（变量）的简写。[下一章](/03_functions)中我们会具体介绍它与`let`的差别，现在只需要记住它的功能基本和`let`一样就行。但是本书中基本不会用到它，因为它有很多模糊不清的属性。

关键词`const`代表的是英文单词*constant*（常量，保持不变的）。它定义的是一个不变的绑定，只要这个绑定存在，它就永远指向（抓着）同一个值。这种绑定方式就让使用一个值变得容易了。

## 绑定名称

绑定的名称可以是任何英文词。数字也可以是绑定名称的一部分，例如`catch22`就是一个可用的名字。但是，请注意，名称不能以数字开头。绑定名称可以包含美元符号（$）或者下划线（\_），但是不能有其他的标点符号或特殊字符。

有些有特殊意义的单词，如`let`，都是*关键词*，它们都不能当作绑定名称。还有很多单词被预留了，以备 JavaScript 程序在未来用到它们，所以这些词也不能用于绑定名称。关键词和预留词的名单有点儿长。

```
break case catch class const continue debugger default
delete do else enum export extends false finally for
function if implements import interface in instanceof let
new package private protected public return static super
switch this throw true try typeof var void while with yield
```

不用费心来记忆这些次。当创建绑定时如果提示出错了，那么有可能就是你用了不能用的词了。

## 环境

在给定的、特定的时间内存在的一些绑定和它们的值的集合被称为*环境*。当一段程序刚开始时，那个环境不是空的。因为它总是包含着那个语言本身拥有的绑定，以及大多数时候，还有那个语言与周围的系统进行交互所用到的那些绑定。例如在一个浏览器中，就有用于和当前加载好的这个网站进行互动所用到的函数，以及读取鼠标、键盘动作所用到的函数。

## 函数（function）

默认环境中提供的很多值都拥有*函数*类型。一个函数就是包裹在一个值中的一段程序。可以*应用*这些值用以来运行被包裹其中的程序。例如在浏览器环境中，名为`prompt`的绑定就保存着（抓着）一个函数，这个函数用来显示一个让用户输入内容的对话框，就像这样：

```javascript
propmt("输入通行密码");
```

![Prompt](/img/prompt.png)

执行一个函数被称为*唤起*（invoking）、_调用_（calling）或*应用*（applying）。在一个可以产生函数值的表达式后面加上英文括号就可以调用一个函数。通常情况下，你可以直接使用保存着函数的那个绑定的名称。英文括号中的值是给定到函数内部的程序的。上例中的`propmt`函数使用了我们给它的字符串，把它显示在了对话框中。给到函数的值被称为*参数*。不同的函数可能需要不同数量、不同类型的参数。

在现代网络编程中，`prompt`函数很少被用到了，因为你很难控制对话框的样子。但在实验性的开发或者是试着玩儿的情况下，它还是挺有用的。

## console.log 函数

在本书的例子中，我使用`console.log`来输出值。大多数 JavaScript 系统（包括所有的现代浏览器和 Node.js）都提供一个`console.log`函数，用来在*某些*文本输出设备中写出给到它的参数内容。在浏览器中，输出内容显示在 JavaScript 控制台。浏览器的这部分功能界面（JavaScript 控制台）默认是隐藏的，大多数浏览器都可以通过 F12 键或者在苹果电脑上按`command+option+j`组合键来打开。如果按键不起作用的话，在菜单中选择「开发者工具」或类似的名称也可以打开它。

</Layout>
